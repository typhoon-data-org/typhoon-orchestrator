name: filesystem_to_db
args:
  filesystem_hook: FileSystemHook
  pattern: str
  db_hook: DBApiHook
  table_name: str

tasks:
  glob_files:
    function: typhoon.filesystem.glob
    args:
      hook: !Py $ARG.filesystem_hook
      pattern: !Py $ARG.pattern

  write_to_db:
    input: glob_files
    function: typhoon.pandas.write_sql
    args:
      a: a


output:
  - write_to_db
